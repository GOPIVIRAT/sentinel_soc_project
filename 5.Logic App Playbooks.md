# LOGIC APP PLAYBOOKS:
<img width="698" height="176" alt="image" src="https://github.com/user-attachments/assets/48d923dc-7890-418b-a940-93a3c5a42e57" />

## ğŸ“˜ Auto-Close Informational & Low Incidents Playbook
## ğŸ“Œ Overview ##

This Logic App playbook is designed to automatically close Informational & Low incidents in Microsoft Sentinel.
It works together with an Automation Rule that triggers the playbook whenever a new incident with Severity = Informational is created.

This reduces noise, removes non-actionable alerts, and helps SOC analysts focus on high-value incidents.

## ğŸ¯ Purpose ##

Automatically close low-value Informational incidents

Reduce manual workload for SOC analysts

Maintain a clean incident queue

Improve SOC efficiency and response time

## âš™ï¸ How It Works (Workflow) ##

An Automation Rule checks each newly created incident.

If the severity is Informational, the rule triggers this playbook.

## The playbook: ##

Retrieves the incident details

Updates the incident status â†’ Closed

Adds a closing comment

Tags the incident (optional)

No manual action required by the SOC team.

## ğŸ§© Playbook Logic (Steps Inside Logic App) ##

Trigger: â€œWhen an incident is createdâ€

Get Incident Details

Update Incident

Status â†’ Closed

Closing Reason â†’ Benign Positive / Resolved

Comment â†’ â€œAutomatically closed: Informational incident (noise reduction).â€

## Screenshots ##

in the incident page you can see there was alert which is informational 
<img width="1116" height="396" alt="image" src="https://github.com/user-attachments/assets/957fca61-d59a-4b15-9178-f783bf4eba96" />
Then i was able to create a playbook in the logic app to close the incident
<img width="951" height="465" alt="image" src="https://github.com/user-attachments/assets/cb28b626-e641-4a6c-ab37-0c2689633597" />
Then i was able to write a automation rule when ever new incident came with severity low & Information close that incident 
<img width="1110" height="594" alt="image" src="https://github.com/user-attachments/assets/0f2fa7e9-58fe-4702-8f7c-e5009dc97655" />
Then i have written a query to attach this automation rule you can see that in the screenshot
<img width="1040" height="434" alt="image" src="https://github.com/user-attachments/assets/e0d8feda-9ef6-44fe-a0e1-dfbeffa32e57" />
Then you can see That my incident was automatically investigated and resolved by the automation rule
<img width="406" height="125" alt="image" src="https://github.com/user-attachments/assets/f9d6940c-eeea-4bcb-9b2b-9502ad889afb" />

# ğŸ” User Creation Detection + Entra ID Disable/Enable Playbook
**ğŸ“Œ Overview**

This workflow detects when a specific user account is created (example: virat@gopisidâ€¦) and automatically disables or enables the user using a Logic App playbook.
Simple, clear, and useful for SOC identity response.

**ğŸ”„ Workflow Summary (Easy to Understand)**

**1ï¸âƒ£ User Created in Entra ID**

A new user is created.
Example detected in logs:

Operation: Add user

Target User: virat@â€¦

Created By: gopisiddams@â€¦

Result: success

**2ï¸âƒ£ Analytics Rule â€“ Detect User Creation**

A custom Analytics Rule runs a KQL query to detect when a user named Virat (or any new user) is added.

Sample KQL:
<img width="983" height="359" alt="image" src="https://github.com/user-attachments/assets/388f2b93-fdf2-49e5-bb1f-e15175e71f67" />

If the TargetUser matches the condition, the rule triggers an incident.

**3ï¸âƒ£ Playbook â€“ Disable or Enable the User**

The Logic App playbook performs:

Disable user â†’ accountEnabled = false

Enable user â†’ accountEnabled = true

Adds a comment to the incident

Updates SOC team

Uses Managed Identity + Graph API

This helps automate response to suspicious or unwanted user creation.

**Screenshot with Explanation:**

**First in entra id i am creating the new user virat you can see that in the screenshot**
 <img width="480" height="529" alt="image" src="https://github.com/user-attachments/assets/160fe122-a316-4a82-bab9-8da3811af41b" />
 
**Then i was able to write a kql query that will effectiverly detect these type of attacks**
<img width="963" height="344" alt="image" src="https://github.com/user-attachments/assets/76abad64-7aac-4095-9709-29a3b8abb8be" />

**I am saving the rule New User created**
<img width="1084" height="558" alt="image" src="https://github.com/user-attachments/assets/e9db0514-ee6a-4c7d-8d0a-c20351f1db73" />


**we can see in the incident page the rule was triggered**
<img width="1114" height="336" alt="image" src="https://github.com/user-attachments/assets/efbdad9c-b1e2-4a89-a43a-936e1e7a6cf5" />

**Then i was able to build a playbook to enable or disable these type of incidents**
<img width="1110" height="483" alt="image" src="https://github.com/user-attachments/assets/1943d41e-c8ac-4886-b851-77ef85a03376" />

<img width="387" height="464" alt="image" src="https://github.com/user-attachments/assets/034f6463-ab54-458b-b0c5-bf0a473cb3dc" />

**its time to run our playbook on the incident**
<img width="1349" height="473" alt="image" src="https://github.com/user-attachments/assets/f7b4efae-d482-49c9-8747-90bc08b1d3f5" />

**After running the playbooks we can be able to enable and disable the users**
<img width="1362" height="556" alt="image" src="https://github.com/user-attachments/assets/98e37302-a5e9-4948-922d-36a91ed34533" />
<img width="1169" height="456" alt="image" src="https://github.com/user-attachments/assets/fe4c7889-5e97-44f3-b465-0fcfd688f6f3" />


# ğŸ›¡ï¸ VirusTotal IP Reputation Lookup Playbook (Using Threat Indicators)
## ğŸ“Œ Overview

This playbook takes IPs from Threat Intelligence Indicators in Microsoft Sentinel, sends them to VirusTotal, receives reputation details, and then sends the final report to email.
This helps analysts quickly understand whether an external IP is malicious or suspicious.

## ğŸ”„ Workflow Summary
## 1ï¸âƒ£ Extract IPs from Threat Indicators

The playbook reads threat intelligence items (TI Indicators) stored in Sentinel.
Example sources:

External threat feeds

TI connectors

Imported IOC lists

The playbook extracts:

Indicator type (IP)

The actual IP value

## 2ï¸âƒ£ Send IP to VirusTotal API

Each extracted IP is passed to VirusTotal using an HTTP action.

VirusTotal returns details such as:

Malicious / Suspicious / Harmless

Number of engines reporting the IP as malicious

Category and reputation

Community votes

## 3ï¸âƒ£ Format the Report

The playbook formats the reputation data into a readable report, including:

IP address

Detection ratio

Analysis categories

Detailed results

## 4ï¸âƒ£ Email the Results

A full report for every IP is sent to your mailbox using:
Outlook connector
This allows quick review without opening Sentinel.

## Screenshot with Explanation:

**Firstly i was able to create a detection rule to extract the suspicious ip's**
<img width="989" height="455" alt="image" src="https://github.com/user-attachments/assets/24e7b2dc-bc9c-448e-aaf7-10936de665d4" />

**you can see that the rule was triggered and there was 10 ip's extracted**

<img width="1097" height="599" alt="image" src="https://github.com/user-attachments/assets/c64d70f0-b312-40d8-a50e-79cc04a2c706" />

**Then i was able to build a playbook that will get the report of individual ip's**

<img width="1099" height="468" alt="image" src="https://github.com/user-attachments/assets/d88c3291-070a-43e5-8c4f-52dc21d4913e" />

**After that i am manually Triggering the incident**

<img width="1104" height="488" alt="image" src="https://github.com/user-attachments/assets/bc01b50a-9213-4b05-b073-634f5b2a4090" />



**You can see the report of ip's here**
<img width="618" height="344" alt="image" src="https://github.com/user-attachments/assets/569d2272-44a7-4c89-b40b-2962bae4e289" />



**After that i was able to send the whole report to my email**

<img width="652" height="508" alt="image" src="https://github.com/user-attachments/assets/9939589f-dbc5-4ee5-b39d-889b1107d76f" />
<img width="1123" height="552" alt="image" src="https://github.com/user-attachments/assets/9eacdd4f-c390-45b8-a535-5baa566c10e7" />



# ğŸ§ª VirusTotal Enrichment Playbooks (URL, Domain, File Hash)
## ğŸ“Œ Overview ##

After completing the full IP reputation playbook and seeing it work end-to-end, I built three additional VirusTotal enrichment playbooks:

URL Reputation Playbook

Domain Reputation Playbook

File Hash Reputation Playbook

These were created to demonstrate my ability to design and automate different types of threat-enrichment workflows, even though the IP playbook already covered the practical testing.

## ğŸ”¹ 1ï¸âƒ£ URL Reputation Playbook ##

Purpose

Takes a URL as input, sends it to VirusTotal, and retrieves:

Malicious / Suspicious score

Detection engines results

URL categories

Final reputation status

## Workflow Summary ##

Receive URL

Send to VirusTotal API

Parse JSON response

Format results

Email or log the final report

## Screenshots ##

<img width="311" height="462" alt="image" src="https://github.com/user-attachments/assets/20f051f4-2600-4115-8d1b-84ead6b076c3" />

<img width="1120" height="491" alt="image" src="https://github.com/user-attachments/assets/1b651887-e9ab-42bb-a0d4-14d8af97945f" />


## ğŸ”¹ 2ï¸âƒ£ Domain Reputation Playbook ##
Purpose 

Checks the reputation of a domain using VirusTotal.

Returns:

Domain categorization

Registrar information

Malicious/suspicious flags

Community votes

Workflow Summary

Receive domain value

VirusTotal domain endpoint query

Extract key results

Send report to email or Sentinel

## Screenshots ##

<img width="323" height="471" alt="image" src="https://github.com/user-attachments/assets/390d40ba-6778-45d6-8343-54d7f1e611ae" />

<img width="1143" height="361" alt="image" src="https://github.com/user-attachments/assets/cee71911-ca08-47d3-ab4d-948617bf0f2b" />


## ğŸ”¹ 3ï¸âƒ£ File Hash Reputation Playbook ##
Purpose

Takes a file hash (MD5 / SHA1 / SHA256) and retrieves:

Malware detection score

Number of malicious detections

File classification

Behavior information (if available)

## Workflow Summary ##

Receive file hash

VirusTotal file-report API call

Parse detection engines

Format structured report

Email to SOC analyst

## Screenshots ##

<img width="319" height="473" alt="image" src="https://github.com/user-attachments/assets/ece35690-f4b9-4ab2-b688-39b435fc1e0f" />

<img width="1137" height="537" alt="image" src="https://github.com/user-attachments/assets/febeee14-d945-4f46-ac12-cf5d7b712cb8" />


# ğŸ“Œ HTTP â†’ Blob Storage â†’ Email Alert Playbook

## Azure Logic App â€“ Storage Monitoring Automation ##

This playbook demonstrates how an HTTP-triggered Logic App can write data into Azure Blob Storage, and how this activity can generate an alert that is delivered to the SOC analyst via email.
This workflow shows how external interactions can lead to storage activity and how SOC automation can detect and notify analysts.
<img width="766" height="157" alt="image" src="https://github.com/user-attachments/assets/88fb4e6d-4bf7-41e5-8e26-505bf93c583b" />


**ğŸš€ Overview**

This Logic App performs three main actions:

Receives an HTTP request with a query parameter (e.g., name).

Creates a Blob file inside Azure Storage using that parameter.

Returns a response back to the requester.

A Sentinel/Defender analytics rule then monitors storage activity and sends an email alert whenever a file is created.

This helps SOC analysts detect unusual or suspicious uploads to storage accounts.

## ğŸ› ï¸ Playbook Steps

**1ï¸âƒ£ HTTP Trigger**

The Logic App starts with the â€œWhen an HTTP request is receivedâ€ trigger.
A sample request looks like:
<img width="541" height="97" alt="image" src="https://github.com/user-attachments/assets/4317b68a-503a-49e1-b0ec-5ba8550dd0d7" />

The Logic App extracts the value of name.

**2ï¸âƒ£ Create Blob (V2)**

This is the main action of the playbook.

**The Logic App:**

Connects to the selected Storage Account

Uses a predefined folder (example: /kohli)

Creates a .txt file using the provided name

Writes a simple text message inside the file

Blob Name Example:

hacker.txt


Blob Content Example:

hello hacker!


So whatever name is passed in the request becomes both:

the filename

and part of the content stored inside Blob Storage.

**3ï¸âƒ£ HTTP Response**

After creating the blob, the Logic App sends a response back to the requester.

Example response:

hello hacker


This confirms that the request was processed successfully.

## ğŸ¯ Purpose of This Playbook ##

**This automation shows:**

âœ”ï¸ How to trigger a Logic App using HTTP

âœ”ï¸ How to pass parameters dynamically

âœ”ï¸ How to store incoming data into Azure Blob Storage

âœ”ï¸ How to build simple, clean automation workflows

âœ”ï¸ This playbook helpful to get the alert whenever any one try to store anything via manual way or using any scripts to store anything i will get the alert 
## ğŸ“¸ Screenshots ##

**Overview of the architecture**
<img width="766" height="157" alt="image" src="https://github.com/user-attachments/assets/795610a8-481b-4188-be00-766965564914" />

**playbooks**

<img width="1349" height="544" alt="image" src="https://github.com/user-attachments/assets/dbf8e28f-71cc-4cdb-aca4-91c71b12f6e7" />
<img width="1094" height="499" alt="image" src="https://github.com/user-attachments/assets/6f790482-ea0b-4769-acf5-8ea59f15b127" />

**By taking the get request parameter like hacker it will store in the storage account**
<img width="541" height="97" alt="image" src="https://github.com/user-attachments/assets/b8625426-994e-4e8e-84f8-197a4a9718b1" />
<img width="1366" height="343" alt="image" src="https://github.com/user-attachments/assets/cb19b37c-2d05-497c-aefe-a202b21461ee" />
<img width="1366" height="516" alt="image" src="https://github.com/user-attachments/assets/b48f2001-5952-4759-9574-f10cbdaed475" />

**After that eveytime when someone upload or store anything i can get the alert to my email through my playbook**
<img width="272" height="510" alt="image" src="https://github.com/user-attachments/assets/993d2481-f446-41c8-89d7-b09a050c8de8" />
<img width="255" height="506" alt="image" src="https://github.com/user-attachments/assets/a99a216b-cc53-4fc4-bbd8-63fcc9e31228" />


















